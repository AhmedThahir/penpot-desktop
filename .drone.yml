---
kind: pipeline
type: exec
name: Build on macOS (M2)

clone:
  retries: 3

platform:
  os: darwin
  arch: arm64

steps:
- name: Test
  commands:
    - echo "Hello world!"

- name: Build
  commands:
    - echo "Hello world!"
  depends_on:
  - Test

---
kind: pipeline
type: exec
name: Build on Linux

clone:
  retries: 3

platform:
  os: darwin
  arch: arm64

steps:
- name: Test
  commands:
    - echo "Hello world!"

- name: Build
  commands:
    - echo "Hello world!"
  depends_on:
  - Test

---
kind: pipeline
type: exec
name: Publish

depends_on:
- Build on macOS (M2)

clone:
  retries: 3

platform:
  os: darwin
  arch: arm64

- name: Publish
  commands:
    - echo "Hello world!"