Prepare:
  stage: .pre
  only:
    - main
  script:
      - echo "Prepare"
    # - export $(grep -v '^#' .env | xargs)
    # - mkdir /korbs-studio-server/nginx/sites/releases/applications/penpot-desktop/$VERSION/

Windows:
  tags:
    - WindowsVM
  stage: build
  only:
    - main
  script:
    - echo "Get dependencies"
    - echo "Check dist/ directory"
    - echo "Run build"
    - sleep 10
    - echo "Testing SFTP"
    - sleep 2
    - sftp $SFTP_USERNAME@$SFTP_IP
    - echo "Test - 1"

Linux:
  stage: build
  only:
    - main
  script:
    - echo "Get dependencies"
    - echo "Check dist/ directory"
    - echo "Run build"

Windows-Ready:
  stage: deploy
  only:
    - main
  needs:
    - Prepare
  script:
    - echo "Prepare to upload..."
    - echo "Upload files to main server..."
    - echo "Remove dist/ folder for future builds."

Linux-Ready:
  stage: deploy
  only:
    - main
  needs:
    - Prepare
    - Linux
  script:
    - echo "Prepare to upload..."
    - echo "Upload packages to Cloudsmith..."
    - echo "Remove dist/ folder for future builds."
